## Azure VMの可用性の管理

### 可用性セット

- サービスが中断されないようにするため、また、単一障害点を回避するために、VM ごとに 2 つのインスタンスをデプロイすること推奨。この機能は **可用性セット** と呼ばれる
- 可用性セットは、デプロイされるVM全部が単一障害点の制限下に含まれないように、また、データ センターでホスト オペレーティング システムがアップグレードされるときに全VMが同時にアップグレードされないように、関連 VM のグループを確実にデプロイするための論理機能
- 可用性セットに配置された VM では、同じ機能セットを実行する必要があり、同じソフトウェアをインストールする必要がある
- Microsoft は、ある可用性セットにデプロイされたマルチインスタンス VM に対して、99.95% の外部接続性サービス レベル アグリーメント (SLA) を提供
  - 適用する SLA に対して、ある可用性セット内に少なくとも 2 つの VM インスタンスをデプロイする必要がある
- 可用性セットは Azure portal のディザスター リカバリー セクションから作成
- 可用性セットに VM を配置するとき、Azure では、必ず障害ドメインと更新ドメインに分散配置する
  
- Azure Site Recovery では、プライマリ サイトからセカンダリの場所にワークロードが複製
  - Azure Site Recovery の目標は仮想マシンまたは物理マシンの複製にあります。停電時、ワークロードの可用性を維持
  - Site Recovery を利用すれば、Azure を復元先として利用可能
    - 第二の物理データセンターを保守するためのコストと煩雑さから解放される
  - Site Recovery では、運用環境に影響を与えることなく、復旧演習でフェールオーバーを極めてシンプルにテスト可能
    - 結局のところ、フェールオーバーを試したことがなければ、良いディザスター リカバリーを計画できない
  - 計画にはカスタム PowerShell スクリプト、Azure Automation Runbook の手動介入手順を含めることができる

## 仮想マシンをバックアップする

### Azure Backup

- Azure Backup は、オンプレミスとクラウドを問わず、物理コンピューターと仮想マシンを保護する**サービスとしてのバックアップ**
- より詳細は[こちら](../AzureAvailability/AzureBackup.md)

#### 対象

- Windows OS コンピューター上のファイルとフォルダー (物理または仮想、ローカルまたはクラウド)
- アプリケーション対応スナップショット (ボリューム シャドウ コピー サービス)
- Microsoft SQL Server、Microsoft SharePoint、Microsoft Exchange などのワークロード
- Azure Virtual Machines のネイティブ サポート、Windows と Linux の両方
- Linux と Windows 10 のクライアント コンピューター

#### その他の特徴

- ストレージ管理の自動化。 Azure Backup は、従量制課金モデルを使用して、バックアップ ストレージを自動的に割り当てて管理します。 料金は使用した分だけになります。
- 無制限のスケーリング。 Azure Backup では、Azure のパワーと拡張性が利用され、可用性が高くなります。
- 複数のストレージ オプション。 Azure Backup はローカル冗長ストレージを提供します。データのコピーはすべて同じリージョン内に存在し、geo 冗長ストレージでは、複製されたデータがセカンダリ リージョンに置かれます。
- 無制限のデータ転送。 転送する受信データまたは送信データ量に制限がありません。 転送データに対して料金は発生しません。
- データの暗号化。 データの暗号化により、Azure において、セキュリティで保護された転送と保存が実現します。
- アプリケーションの整合性のバックアップ
  - アプリケーション整合性バックアップは、復旧ポイントがバックアップ コピーを復元するために必要なすべてのデータを持っていることを意味します。 Azure Backup では、アプリケーション間で一貫性のあるバックアップが行われます。
- 長期保存。 Azure では、バックアップ データを維持する時間に制限がありません。

#### コンポーネント

Azure Backup では、ダウンロードし、バックアップするコンピューターにデプロイするコンポーネントがいくつか活用されます。 デプロイするコンポーネントは、保護する内容によって異なります。Azure Backup では、バックアップ データの格納に **Recovery Services コンテナー**を使用

- Azure Backup エージェント
- System Center Data Protection Manager
- Azure Backup Server
- Azure Backup VM 拡張機能
