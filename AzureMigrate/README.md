# 移行、その前に

## 移行の計画

まずは移行の計画を立てる必要がある。
以下の様な移行のフレームワークがある。

1. 評価
2. 移行
3. 最適化
4. 監視

### 1．評価

#### 検出と評価

- 移行対象を洗い出す。対象に紐づく組織・チームも併せて洗い出し、参加してもらう。
- 移行のオプションを検討する
  - 再ホスト: 既存のインフラストラクチャを Azure に作成し直します。 この方法を選択すると、必要な変更が最小限になるため、影響は最も小さくなります。 それには、通常、データ センターから Azure 上の仮想マシンへの仮想マシンの移動が含まれます。
  - リファクター: 仮想マシン上で実行されているサービスをサービスとしてのプラットフォーム (PaaS) サービスに移行します。 この方法では、運用要件を軽減し、リリースの機敏性を向上させ、コストを低く抑えることができます。 クラウドでより効率的に実行するための小規模な機能強化によって、パフォーマンスに大きな影響を与えることができます。
  - 再設計: 一部のシステムでは、移行できるようにするために再設計を余儀なくされる場合があります。 他のアプリでは、クラウド ネイティブになるように変更したり、コンテナーやマイクロサービスのような、ソフトウェアへの新しいアプローチを利用したりする場合があります。
  - 再構築: 再設計する方が最初からやり直すよりもコストが高い場合は、ソフトウェアの再構築が必要になることがあります。
  - 置換: 資産を確認している間に、サードパーティ製アプリケーションでカスタム アプリケーションを完全に置き換えることが可能なことがわかる場合があります。 既存のアプリケーションを置き換えるために使用できる、サービスとしてのソフトウェア (SaaS) オプションを評価します。

#### 利害関係者

計画ステージからステークホルダーに参加してもらい、ビジネス側からの知見等をだしてもらう

#### コスト削減を見積もる

TCO計算ツールなどを利用して、コストを見積もる

#### ツールを特定する

サービスまたはツール | ステージ | 用途
-----------|------|---
Azure Migrate | 評価と移行 | Azure に対して、VMware VM、Hyper-V VM、クラウド VM、物理サーバー、およびデータベース、データ、仮想デスクトップ インフラストラクチャ、Web アプリケーションを評価し、移行を実行します。
Service Map | 評価 | Windows または Linux 上のアプリケーション コンポーネント間の通信をマップします。 移行対象の範囲を決定するときに依存関係を特定するのに役立ちます。
Azure TCO 計算ツール | 評価 | Azure とオンプレミスでの毎月のランニング コストを見積もります。
Azure Database Migration Service | 移行 | Data Migration Assistant と Azure portal を使用して、データベース ワークロードを Azure に移行します。
データ移行ツール | 移行 | 既存のデータベースを Azure Cosmos DB に移行します。
Azure Cost Management | 最適化 | 進行中の Azure のコストを監視、制御、最適化するのに役立ちます。
Azure Advisor | 最適化 | 高可用性、パフォーマンス、コストのために Azure リソースを最適化するのに役立ちます。
Azure Monitor | 監視 | 資産全体のパフォーマンスを監視できます。 拡張されたテレメトリを使用したアプリケーションの正常性の監視と、通知の設定が含まれます。
Azure Sentinel | 監視 | アプリケーションに関するインテリジェントなセキュリティ分析が提供されます。

### 2．移行

- 移行先の環境を用意
  - ツールで準備される範囲と自前で用意する範囲の明確化
- ワークロードを移行
  - 移行元 (vCenter Server) 環境と移行先 (Azure) 環境を準備します。
  - この 2 つの間でのレプリケーションを設定して開始します
  - レプリケーションが正常に動作したことをテストします。
  - 移行元サーバーから Azure にフェールオーバーします。
  - データベースの移行では、大まかな手順は次のとおりです。
    - オンプレミス データベースを評価します。
    - スキーマを移行します
    - Azure Database Migration Service プロジェクトを作成して実行し、データを移動します。
    - 移行を監視します。
- オンプレミスのインフラを停止

### 3. 最適化

- 運用コストを分析
  - Azure Cost Management
  - Azure Advisorなどでコスト削減の可能性調査

### 4. モニター

- サービスの正常性・パフォーマンスの監視

