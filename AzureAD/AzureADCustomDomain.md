# Azure ADにカスタムドメインを追加

## 概要

### カスタムドメイン追加、とはどういうことか

- Azure AD テナントにはすべて、 `<domainname>.onmicrosoft.com` という初期ドメイン名が付く
- 初期ドメイン名は変更したり削除したりできませんが、お客様の組織の名前を追加することは可能
- カスタム ドメイン名を追加すると、alain@contoso.com など、**ユーザーになじみのあるユーザー名を作成**するのに役立ちます。

### 前提

カスタムドメインを追加するには、当然だが予めドメインレジストラーでドメインを作成しておく必要がある。

## カスタムドメイン追加手順

1. Azure ADディレクトリを作成
2. カスタムドメインを追加
3. ドメインレジストラーにDNS情報を追加
4. カスタムドメイン名を検証

### 1. ディレクトリの作成

- サブスクリプションの**所有者**ロールを持つアカウントで作成
- テナント=ディレクトリの作成者が自動的にそのテナントの全体管理者となる
- オンプレADとフェデレーションする予定の場合は、ディレクトリ同期でAzureADConnectを実行する際に、`このドメインを構成してローカルActiveDirectoryにシングルサインオンします`を選択

### 2. カスタムドメインを追加

![picture 1](images/9d9d0adde8404e120dc6c25837e5ae18daa746b0540c2fc180c77313db3303fa.png)  

![picture 2](images/4b9516cc71f48a140bd5b16b6524c05b355f1bb14aff0ac2b4a96c65ad6f46d5.png)  

- 以下の通り、未確認ドメインが追加され、contoso.com ページが表示され、DNS 情報が表示されます。
  - この情報は保存してください。 後で TXT レコードを作成して DNS を構成する際に、この情報が必要になります。

![picture 3](images/fc1043fbb8ca86aa75414b991245ab63d7b52743a713f94976e7e0f5ca9c22f3.png)  

### 3. ドメインレジストラーにDNS情報を追加

2のステップでコピーした情報をドメインレジストラーの新しいTXTレコードを作成する。

### 4. カスタムドメイン名を検証

Azure ADで設定したドメインが有効になっているか確認する。

- Azure Portalにログインし、Azure ADを選択して、カスタムドメイン名を選択
- `「Verify」` を押して有効かどうか確認する。