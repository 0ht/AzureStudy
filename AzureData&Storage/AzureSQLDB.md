# Azure SQL

Azure SQL
https://docs.microsoft.com/ja-jp/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview

MS Learnじゃちょっと足りない感

## 概要

そもそも・・・  

Azure SQL は、管理され、セキュリティで保護されたインテリジェントな製品のファミリであり、Azure クラウドで SQL Server データベース エンジンを使用します。

- **Azure SQL Database （PaaS)**
  - サーバーレス コンピューティングを含む、インテリジェントな管理されたデータベース サービスで最新のクラウド アプリケーションをサポートします。
  - 単一もしくはエラスティックプールとしてデプロイ
  - 仮想コアおよびDTUベースの購入モデル
- **Azure SQL Managed Instance （PaaS)**
  - インテリジェントなサービスとしてのフル マネージド インスタンスを使用して、既存の SQL Server アプリケーションを大規模に最新化し、SQL Server データベース エンジンとほぼ 100% の機能パリティを実現します。 クラウドへの移行に最適です。
  - 仮想コアベースの購入モデルのみ（Gen4 | Gen5）
- **Azure VM 上の SQL Server**
  - SQL Server のワークロードを簡単に移行 (リフト アンド シフト) し、SQL Server との 100% の互換性とオペレーティング システム レベルのアクセスを維持します。

![picture 7](images/ee02e60215fea7048f48c8161a06252b721624570acbd0926ab540d394a5a524.png)  

以下、AzureSQL Databaseとは
- Azure のManaged RDB
- SQLServerのクラウド版
- データベースの管理コンテナーとして論理サーバーという概念がある
- エラスティックプール

## 2つの購入モデル

### DTU（Database Transaction Unit）

- コンピュート、ストレージ、IOリソースの統合された指標。シンプルな事前定義済みの購入オプションと考えることができる
- 論理サーバー構成では、複数のデータベースが管理可能であり、このプールをeDTUとして、eDTUでリソースを融通可能

### 仮想コア

- DTUに対し、より柔軟にコンピュートリソースとストレージリソースを詳細に制御可能
- 

## SQL エラスティックプール

- SQL エラスティック プールでは、プール内のすべてのデータベース間で共有されるコンピューティング リソースとストレージ リソースのセットを購入可能
- 各データベースでは、現在の負荷に応じて、設定された制限内で必要なリソースを使用可能
- 平均使用率は低いが、低頻度で使用率が急激に高くなるいくつかの SQL データベースを備えている場合に、SQL エラスティック プールは最適
- 1 つのプールにおいてコスト削減の可能性を求めるには、少なくとも S3 データベースを 2 個、または S0 データベースを 15 個追加することをお勧め

## 照合順序

- 照合順序とは、データを並べ替えたり比較したりする規則のこと
- 大文字小文字の区別、アクセント記号、その他の言語の特性が重要なときに並べ替え規則を定義する場合に、照合順序が役立つ

## Always Encrypt

- Always Encrypted はデータ暗号化テクノロジ
- サーバーでの保存時、クライアントとサーバー間の移動中、およびデータの使用中も機密データを保護
- データ暗号化の構成後に、プレーンテキスト データにアクセスできるのは、キーへのアクセス権を持つクライアント アプリケーションまたはアプリケーション サーバーだけ

特定の列を暗号化する手順

- Column マスターキーを作成
- Column マスターキーを使用してColumn暗号化キーを作成
- Column 暗号化キーで列を暗号化
- アプリケーション接続文字列でColumn暗号化を有効か